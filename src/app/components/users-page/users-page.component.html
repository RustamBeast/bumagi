<div class="wrapper">
    <div *ngIf="this.users.length === 0" class="box">
        <div class="loader6"></div>
    </div>
    <div *ngIf="this.userToChange" class="user__popup">
        <div class="user__form">
            <div class="user__form-header">
                <h1>{{this.userToChange.fname}} {{this.userToChange.name}}</h1>
                <button type="button" class="user__form-cancel" (click)="cancelPopup()">
                    <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20.8859 1.11411C20.0668 0.295297 18.7391 0.295297 17.9201 1.11411L11.0131 8.02105L4.10619 1.11411C3.28319 0.319229 1.975 0.330596 1.16593 1.13966C0.356871 1.94872 0.345503 3.25692 1.14038 4.07992L8.04733 10.9869L1.14038 17.8938C0.595133 18.4204 0.37646 19.2003 0.56841 19.9336C0.760361 20.6669 1.33306 21.2396 2.0664 21.4316C2.79973 21.6235 3.57958 21.4049 4.10619 20.8596L11.0131 13.9527L17.9201 20.8596C18.7431 21.6545 20.0513 21.6431 20.8603 20.8341C21.6694 20.025 21.6808 18.7168 20.8859 17.8938L13.9789 10.9869L20.8859 4.07992C21.7047 3.26086 21.7047 1.93317 20.8859 1.11411Z" fill="#6979F8"/>
                    </svg>
                </button>
            </div>
            <form (ngSubmit)="sendUserChangeRequest()" [formGroup]="userForm">
    
                <input class="form-control" formControlName="fname" id="inputFname"
                        name="fname"
                        placeholder="Фамилия" type="text">
                <input class="form-control" formControlName="name" id="inputName"
                    name="name"
                    placeholder="Имя" type="text">

                <input class="form-control" formControlName="mname" id="inputMname"
                    name="mname"
                    placeholder="Отчество" type="text">

                <ng-select class="custom" [items]="statuses" 
                        bindLabel="name" 
                        bindValue="id" 
                        formControlName="status">
                </ng-select>

        
                <button class="user__form-save" type="submit">Сохранить</button>
    
            </form>
        </div>
    </div>
    <div *ngIf="this.users.length !== 0" class="users">
        <div *ngIf="!this.userToChange" class="users__type">
            <div class="users__type-box">
                
                    <div class="users__type-button">
                        <input (change)="showAllUsers()" type="radio" id="all" name="status" value="all" [checked]="this.category === 1">
                        <label for="all">Все</label>
                    </div>
             
                    <div class="users__type-button">
                        <input (change)="showBlockedUsers()" type="radio" id="blocked" name="status" value="blocked" [checked]="this.category === 2">
                        <label for="blocked">Заблокированные</label>
                    </div>
             
                    <div class="users__type-button">
                        <input (change)="showActiveUsers()" type="radio" id="active" name="status" value="active" [checked]="this.category === 3">
                        <label for="active">Активные</label>
                    </div>
                

            </div>
        </div>
        <ul class="users__list">
            <li class="users__list-element" *ngFor="let user of this.users">
                <button type="button" class="users__list-button" (click)="changeUser(user)">
                    <div class="users__list-image">{{user.id}}</div>
                    <span class="users__list-name">{{user.fname}} {{user.name[0]}}. {{user.mname[0]}}.</span>
                    <span class="users__list-balance">Баланс: {{user.balance.toFixed(2)}}</span>
                    <span class="users__list-update">Последнее изменение: {{getLastUpdate(user.lastUpdatedAt)}} {{getLastUpdateString(user.lastUpdatedAt)}} назад</span>
                    <span class="users__list-status">Подписка {{getStatus(user.status)}}</span>
                </button>
            </li>
        </ul>
        <div class="rectangle"></div>
    </div>
</div>
